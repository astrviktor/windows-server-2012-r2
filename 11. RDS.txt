RDS - Remoute Desctop Services
RDP - Remoute Desctop Protocol

Для удаленного доступа к компьютеру, удаленный рабочий стол

На каждом Windows есть RDP-server и RDP-client, но по умолчанию можно подключить только 2 соединения.

Установка роли RDS-Host на сервер снимает ограничение в 2 подключения.

------------------
Плюсы и минусы RDS
------------------

Плюсы: 
	- Экономия ресурсов, если ПК загружен не польностью.
	- Удобство администрирование
	- Мобильность
	- Возможность оставить нагрузку на сеть внутри корпоративной сети (в случае скачивания больших файлов и т.д.)
	- Лицензирование софта 
Минусы: 
	- Потребление ресурсов (в случае, если один из пользователей займет весь ресурс, у остальных тормоза)
	- Перифирия (возможные сложности подключения)
	- Точка отказа (в случае одного сервера)
	- Совместимость приложений (разных экзотиических)

--------
Роли RDS
--------

RD Session Host - RDP-server
RD Licensing - CAL (Client Access License) Per User / Device (чего меньше)

Этих двух достаточно для работы
Для отказоустойчивости нужны дополнительные роли

RD Connection Broker - балансировка клиентов между серверами по количеству сессий. 
	Для брокеров нужен SQL.
RD Web Access - web-доступ. Могут быть опубликованы приложения, или файлы для подключения.
RG Gateway - специальная роль для безопасности внешних клиентов, так как RDP не очень защещенный протокол. 
	Клиент заворачивает RDP в SSL/TLS

------------------------------------------------------
1. Для включения RDS (без установки ролей и без AD DC)
------------------------------------------------------

	This PC / Properties / Remote Settings / Allow remoute connection to this computer
	Заходим в Firewall / Inbound rules и проверяем правила Remote Desctop - Enable Rule
	Добавляем нужных пользователей в группу - Computer Managment / Local Users and Groups / Remote Desktop Users
	Запуск RDP-client - mstsc.exe или Remote Desktop Connection в меню пуск.

---------------------------------------
2. Создаем VM для RDS (и будущего WSUS)
---------------------------------------

01. Создаем диск для HIPER-V
	Создать -> Жесткий диск
	Формат VHDX
	Раздностный
	Имя: rdswsus.vhdx
	Родительский диск: ws2012r2-base.vhdx

02. Создаем VM
	Имя: rdswsus
	Поколение 1
	Память при запуске: 1024
	Подключение: MainSwitch
	Жесткий диск: Подключить имеющийся rdswsus.vhdx

03. Настройка сетей
	IP 192.168.11.10/24, router 192.168.22.1, DNS 192.168.11.2, 192.168.11.3, 192.168.22.2

----------------------
3. Установка ролей RDS
----------------------

	Add Roles and Features / Remote Desctop services installation / Standart deployment / Session-based ... /
	Все роли ставим на rdswsus - стрелкой вправо

После установки появляется панель Remoute Desctop Services в Dashboard
Дополнительно установим RD Licensing Service
Tasks
	Licensing - per user
	Web Access - попробовать зайти по адресу. Требуется сертификат. 
	Добавляем адрес https://rdswsus.ecorp.local в список доверяемых сайтов.  

Для того, чтобы RDS ввести в инфраструктуру, нужно создать коллекцию. 
До создания коллекции - подключение напрямую, после создания - подключение через брокер.
Один Session Host для одной коллекции.

Remote Desctop Serveces / Colltctions / TASKS / Create Session Collection
	Collection Name - RDSH-Collection

Типы коллекций - Session и Application (Remote App)

URL для WEB доступа: https://rdswsus.ecorp.local/rdweb

Для Remote App нужно просто выбрать программу для публикации.


